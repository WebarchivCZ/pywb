{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Webov\u00fd archiv","text":"<p>N\u00e1stroj \u010cesk\u00e9ho Webov\u00e9ho archivu N\u00e1rodon\u00ed knihovny pro nasazov\u00e1n\u00ed webov\u00e9 slu\u017eby pro zobrazov\u00e1n\u00ed archivovan\u00fdch web\u016f dostupn\u00fd na adrese pywb.webarchiv.cz.</p>"},{"location":"#webrecorder-pywb-toolkit","title":"Webrecorder pywb toolkit","text":"<p>The Webrecorder (pywb) toolkit is a full-featured, advanced web archiving capture and replay framework for python. It provides command-line tools and an extensible framework for high-fidelity web archive access and creation. A subset of features provides the basic functionality of a \u201cWayback Machine\u201d.</p> <p>Pywb je j\u00e1drem cel\u00e9ho \u0159e\u0161en\u00ed. Z\u00e1kladn\u00ed funkc\u00ed je vyhled\u00e1v\u00e1n\u00ed URL v archivu, zobrazov\u00e1n\u00ed webov\u00fdch str\u00e1nek z digit\u00e1ln\u00edch objekt\u016f ulo\u017een\u00fdch ve WARC a ARC a kontrola p\u0159\u00edstup ke kolekci.</p>"},{"location":"Automatizace/komponenty/","title":"Komponenty","text":""},{"location":"Automatizace/komponenty/#automatizacni-kod","title":"Automatiza\u010dn\u00ed k\u00f3d","text":"<p>Automatiza\u010dn\u00ed n\u00e1stroj je uchov\u00e1n na Githubu v repozit\u00e1\u0159i pywb, vlastn\u011bn\u00fdm organizac\u00ed WebarchivCZ.</p>"},{"location":"Automatizace/komponenty/#webrecorder-pywb-toolkit","title":"Webrecorder pywb toolkit","text":""},{"location":"Automatizace/komponenty/#base-images","title":"Base images","text":"<p>Slu\u017eba pywb je provozovan\u00e1 z docker image vytvo\u0159en\u00e9m tv\u016frcem pywb Ilya Kreymer. V\u0161echny dostupn\u00e9 tagy obrazu jsou zve\u0159ejn\u011bn\u00e9 na Dockerhub. V okam\u017eiku psan\u00edho tohoto dokumentu byla nejnov\u011bj\u0161\u00ed verze pywb 2.7.4.</p>"},{"location":"Automatizace/komponenty/#dokumentace","title":"Dokumentace","text":""},{"location":"Automatizace/komponenty/#material-for-mkdocs","title":"Material for MkDocs","text":"<p>Material for MkDocs je framework nad MkDocs kter\u00fd z Markdown dokumentace vytv\u00e1\u0159\u00ed statickou str\u00e1nku. Dokumentace je uchov\u00e1na ve slo\u017ece <code>./docs</code>.</p> <p>P\u0159\u00edkaz <code>./mkdocs.sh</code> spust\u00ed lok\u00e1ln\u00ed dokumentaci na adrese http://0.0.0.0:8000/</p>"},{"location":"Automatizace/komponenty/#github-pages","title":"Github Pages","text":"<p>Github Pages umo\u017e\u0148uje hostov\u00e1n\u00ed statick\u00fdm web\u016f z githubu. V\u010detn\u011b pr\u00e1v\u011b \u010dten\u00e9 Dokumentace.</p> <pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"Automatizace/komponenty/#traefik","title":"Traefik","text":"<p>Traefik sm\u011b\u0159uje po\u017eadavky v\u016f\u010di serveru na konkr\u00e9tn\u00ed slu\u017eby jako je nap\u0159. pywb.</p> <ul> <li>Github Pages</li> </ul>"},{"location":"Automatizace/nasazovani/","title":"Nasazov\u00e1n\u00ed","text":""},{"location":"Automatizace/nasazovani/#pywb-traefik","title":"Pywb &amp; Traefik","text":"<p>Jenkins file instruuje https://jenkins.webarchiv.cz b\u011b\u017e\u00edc\u00ed na wa-dev-docker00.</p>"},{"location":"Automatizace/nasazovani/#infrastruktura","title":"Infrastruktura","text":""},{"location":"Automatizace/nasazovani/#host","title":"Host","text":"<ul> <li>ip: 10.3.0.21</li> <li>user: ansible</li> <li>groups: sudo</li> <li>Jenkins access via /home/ansible/.ssh/authorized_keys</li> </ul>"},{"location":"Automatizace/nasazovani/#pywb-traefik_1","title":"PyWb &amp; Traefik","text":"<ul> <li>Spu\u0161t\u011bn\u00ed:</li> <li>Test: <code>/home/ansible/pywb/run-test.sh</code></li> <li>Produkce: <code>/home/ansible/pywb/run-prod.sh</code></li> </ul>"},{"location":"Automatizace/nasazovani/#stav","title":"Stav","text":""},{"location":"Automatizace/nasazovani/#nyni","title":"nyn\u00ed","text":"<p>pywb: http://10.3.0.21:443 traefik dashboard: http://10.3.0.21</p>"},{"location":"Automatizace/nasazovani/#plan","title":"pl\u00e1n","text":"<p>pywb: https://pywb.webarchiv.cz - ve\u0159ejn\u00fd Traefik dashboard: https://pywb.webarchiv.cz/traefik/ - z knihovny nebo VPN, m\u016f\u017ee b\u00fdt i ve\u0159ejn\u00fd</p>"},{"location":"Pywb/nastaveni/","title":"Nastaven\u00ed","text":""},{"location":"Pywb/nastaveni/#datova-struktura","title":"Datov\u00e1 Struktura","text":""},{"location":"Pywb/nastaveni/#struktura-archivu","title":"Struktura archivu","text":"<p>Sklizn\u011b jsou rozd\u011blen\u00e9 do let a jsou v re\u017eimu read-only. Vyj\u00edmkou je v\u017edy aktu\u00e1ln\u00ed rok.</p> <ul> <li><code>05</code> - Read-only sklizn\u011b z roku 2005, nav\u00edc obsahuje v\u0161echny sklizn\u011b p\u0159ed rokem 2005.</li> <li><code>06</code> - Read-only sklizn\u011b z roku 2006</li> <li><code>23</code> - Read-only sklizn\u011b z roku 2023</li> <li><code>24</code> - Read/Write sklizn\u011b z roku 2024 (aktu\u00e1ln\u00ed rok).</li> </ul> <p>S postupem \u010dasu p\u0159ib\u00fdvali nov\u00e9 typy sklizn\u00ed a strategie skl\u00edzen\u00ed. Zm\u011bnil se archvin\u00ed form\u00e1t z ARC do WARC s p\u0159echodem na Heritrix 3. Nyn\u00ed je na zv\u00e1\u017een\u00ed pou\u017e\u00edv\u00e1n\u00ed archivn\u00edho form\u00e1tu WACZ.</p> <p>Typy sklizn\u00ed jsou pops\u00e1ny na str\u00e1nk\u00e1ch \u010desk\u00e9ho webov\u00e9ho archivu. Obecn\u011b se d\u00e1 \u0159\u00edci, \u017ee v\u00fdb\u011brov\u00e9 sklizn\u011b jsou sklizn\u011b, u kter\u00fdch je vyjedn\u00e1no zp\u0159\u00edstupn\u011bn\u00ed archivovan\u00e9ho obsahu ve\u0159ejnosti a webov\u00fd archiv je skl\u00edz\u00ed periodicky. T\u00e9matick\u00e9 a celoplo\u0161n\u00e9 sklizn\u011b obsahuj\u00ed p\u0159ev\u00e1\u017en\u011b data, k n\u00edm\u017e v \u010dase archivace nebylo vyjedn\u00e1no zp\u0159\u00edstupn\u011bn\u00ed ve\u0159ejnosti, ale mohou se okrajov\u011b p\u0159ek\u00fdvat se zdroji, ke kter\u00fdm bylo vyjedn\u00e1no zp\u0159\u00edstupn\u011bn\u00ed ve\u0159ejnosti. V referen\u010dn\u00edm centru N\u00e1rodn\u00ed knihovny je dostupn\u00fd i archivn\u00ed obsah, kter\u00fd nebyl vyjedn\u00e1n k zve\u0159ejn\u011bn\u00ed a kter\u00fd nen\u00ed omezen z jin\u00fdch d\u016fvod\u016f. Takto popsan\u00fd re\u017eim p\u0159\u00edstup vych\u00e1z\u00ed z \u010desk\u00e9 legislativy.</p> <p>V sou\u010dasn\u00e9 dob\u011b se archiv obvykle skl\u00e1d\u00e1 z n\u00e1sleduj\u00edc\u00edch strategi\u00ed sklizn\u00ed. V\u00fdb\u011brov\u00e9 sklizn\u011b jsou v drtiv\u00e9m p\u0159\u00edpad\u011b realizovan\u00e9 v r\u00e1mci sklizn\u00ed ve slo\u017ece <code>serials</code>, Celoplo\u0161n\u00e9 sklizn\u011b v r\u00e1mci slo\u017eky <code>totals</code>. Ostatn\u00ed sklizn\u011b pln\u00ed prim\u00e1rn\u011b T\u00e9matick\u00e9 sklin\u011b. Koncov\u00fd u\u017eivatel webov\u00e9ho archivu nev\u00ed, v r\u00e1mci jak\u00e9 skl\u00edzec\u00ed strategie a v r\u00e1mci kter\u00e9ho typu sklizn\u011b byla data z\u00edsk\u00e1na. To je technick\u00fd \u00fadaj, kter\u00fd nen\u00ed dostupn\u00fd pomoc\u00ed OpenWayback. V r\u00e1mci Pywb je ur\u010dit\u00e1 \u0161ance, tuto informaci zp\u0159\u00edstupnit.</p>"},{"location":"Pywb/nastaveni/#vyberove-sklizne","title":"V\u00fdb\u011brov\u00e9 sklizn\u011b","text":"<ul> <li><code>serials</code> - V\u00fdb\u011brov\u00e9 sklizn\u011b.</li> <li><code>tests</code> - testovac\u00ed, technick\u00e9 sklizn\u011b na zv\u00e1\u017een\u00ed zda je mo\u017en\u00e9 webovou str\u00e1nku archivovat v dosta\u010duj\u00edc\u00ed kvalit\u011b.</li> </ul>"},{"location":"Pywb/nastaveni/#tematicke-sklizne","title":"T\u00e9matick\u00e9 sklizn\u011b","text":"<ul> <li><code>topics</code>- T\u00e9matick\u00e9 sklizn\u011b</li> <li><code>continuous</code> - pr\u016fb\u011b\u017en\u00e9 sklizn\u011b NewsDigest - T\u00e9matick\u00e9 sklizn\u011b</li> <li><code>continuous-cov19</code> - pr\u016fb\u011b\u017en\u00e9 sklizn\u011b k t\u00e9matu Covid 2019 - T\u00e9matick\u00e9 sklizn\u011b</li> <li><code>continuous-ukrainewar</code> - pr\u016fb\u011b\u017en\u00e9 sklizn\u011b k t\u00e9matu v\u00e1lka na Ukrajin\u011b - T\u00e9matick\u00e9 sklizn\u011b</li> </ul>"},{"location":"Pywb/nastaveni/#celoplosne-sklizne","title":"Celoplo\u0161n\u00e9 sklizn\u011b","text":"<ul> <li><code>totals</code> - Celoplo\u0161n\u00e9 sklizn\u011b</li> </ul>"},{"location":"Pywb/nastaveni/#individualni-sklizne","title":"Individu\u00e1ln\u00ed sklizn\u011b","text":"<ul> <li><code>manuals</code> - ru\u010dn\u00ed sklizn\u011b - T\u00e9matick\u00e9 sklizn\u011b &amp; z mal\u00e9 \u010d\u00e1sti v\u00fdb\u011brov\u00e9 sklizn\u011b</li> </ul>"},{"location":"Pywb/nastaveni/#host","title":"Host","text":"<ul> <li><code>/index/</code> - SSD disk p\u0159ipojen\u00fd pro rychlou pr\u00e1ci s indexem</li> <li><code>/mnt/archive/</code> - Obsahuje sklizen\u00e9 archivy pro ka\u017ed\u00fd rok. Ka\u017ed\u00fd rok je p\u0159ipojen\u00fd p\u0159es NFSv4.</li> </ul>"},{"location":"Pywb/nastaveni/#pywb-docker-image","title":"PyWb docker image","text":"<ul> <li><code>/webarchive/config.yaml</code> - konfigura\u010dn\u00ed soubor</li> <li><code>/webarchive/collections/</code> - adres\u00e1\u0159 se v\u0161emi namapovan\u00fd kolekcemi z <code>/mnt/archive</code></li> </ul>"},{"location":"Pywb/nastaveni/#webrecorder-pywb-toolkit","title":"Webrecorder pywb toolkit","text":""},{"location":"Pywb/nastaveni/#automaticka-indexace","title":"Automatick\u00e1 indexace","text":"<p>Ofici\u00e1ln\u00ed Pywb dokumentace: Dynamic Collections and Automatic Indexing</p> <p>Github Pull Request pro Automatickou Indexace</p>"},{"location":"Pywb/spr%C3%A1va/","title":"Spr\u00e1va kolekc\u00ed","text":""},{"location":"Pywb/spr%C3%A1va/#uzivatele-pywb-test-a-pywb-prod","title":"U\u017eivatel\u00e9 pywb-test a pywb-prod","text":"<p>S archivem se interaguje skrze u\u017eivatele<code>pywb-test</code> a <code>pywb-prod</code>. P\u0159ihl\u00e1\u0161en\u00ed prob\u00edh\u00e1 skrve osobn\u00edho u\u017eivatele a pak se pou\u017eije <code>sudo su - pywb-test</code> nebo <code>sudo su - pywb-prod</code> k z\u00edsk\u00e1n\u00ed termin\u00e1lu pywb. Existuj\u00ed jen produk\u010dn\u00ed kolekce, v nich vytvo\u0159en\u00e9 indexi a z kolekc\u00ed sm\u011b\u0159uj\u00ed symbolick\u00e9 odkazy do \u00falo\u017ei\u0161t\u011b. Samotn\u00fd pywb b\u011b\u017e\u00ed v odd\u011blen\u00fdch kontejnerech, tak\u017ee je mo\u017en\u00e9 konfigurace testovat bez vlivu na produk\u010dn\u00ed prost\u0159ed\u00ed. Nicm\u00e9n\u011b n\u00e1stroje <code>./collection-manager</code> a <code>./cdxj-manager</code> pracuj\u00ed jen se sd\u00edlenou reprezentac\u00ed data. Pokud by bylo k dispozici dost m\u00edsta, je mo\u017en\u00e9 vytvo\u0159it <code>/mnt/index/collections-test</code> a p\u0159ipravit paraleln\u00ed kolekce pro testov\u00e1n\u00ed. Jeliko\u017e n\u00e1stroj uchov\u00e1v\u00e1 ji\u017e vytvo\u0159en\u00e9 indexi v adres\u00e1\u0159i <code>/mnt/index/cdxj-archive/</code>, je mo\u017en\u00e9 p\u0159epou\u017e\u00edt ji\u017e hotov\u00e9 indexy v alternativn\u00edch kolekc\u00edch.</p>"},{"location":"Pywb/spr%C3%A1va/#tmux","title":"Tmux","text":"<p>V\u011bt\u0161ina n\u00e1sleduj\u00edc\u00edch n\u00e1stroj\u016f vytv\u00e1\u0159\u00ed dlouhob\u011b\u017e\u00edc\u00ed procesy. Proto je dobr\u00e9 pou\u017e\u00edvat tmux. Ten umo\u017e\u0148uje se odpojit od termin\u00e1lu ani\u017e by byli zabit dlouhodob\u00fd proces. A je mo\u017en\u00e9 se k termin\u00e1lu s b\u011b\u017e\u00edc\u00edm procesem op\u011bt kdykoliv p\u0159ipojit.</p> <p>Vytvo\u0159en\u00ed nov\u00e9ho okna v <code>tmux</code>u</p> <pre><code>pywb-test@war2:~$ tmux\n</code></pre> <p>Odchod z Tmux termin\u00e1lu bez ukon\u010den\u00ed b\u011b\u017e\u00edc\u00edch proces\u016f.</p> <pre><code>pywb-test@war2:~$ ^b d\n/// tedy zm\u00e1\u010dknou CTRL+b a pot\u00e9 d.\n</code></pre> <p>Uko\u010den\u00ed Tmux termin\u00e1lu (v\u0161echny procesy v termin\u00e1lu budou ukon\u010deny).</p> <pre><code>pywb-test@war2:~$ exit\n</code></pre> <p>P\u0159iojit se k Tmux termin\u00e1lu</p> <pre><code>pywb-test@war2:~$ tmux attach\n</code></pre> <p>Pr\u00e1ce s v\u00edce tmux termin\u00e1ly</p> <pre><code>pywb-test@war2:~$ tmux ls\n10: 1 windows (created Sat Jan  4 00:45:03 2025) (attached)\n11: 1 windows (created Sun Jan  5 20:04:26 2025)\n6: 1 windows (created Fri Jan  3 17:09:01 2025) (attached)\n7: 1 windows (created Fri Jan  3 17:09:20 2025) (attached)\npywb-test@war2:~$ tmux a -t 11\n</code></pre>"},{"location":"Pywb/spr%C3%A1va/#sprace-kolekci-collection-managersh","title":"Spr\u00e1ce Kolekc\u00ed - ./collection-manager.sh","text":"<p>Slou\u017e\u00ed ke spr\u00e1v\u011b kolekc\u00ed. Ka\u017ed\u00e1 kolekce umo\u017en\u00ed zobrazit pouze archivn\u00ed data, kter\u00e9 do n\u00ed pat\u0159\u00ed. Pokud by byli v\u0161echny data jen v jedn\u00e9 kolekci, nebylo by nap\u0159\u00edklad mo\u017en\u00e9 odd\u011blit celoplo\u0161n\u00e9 sklizn\u011b od t\u00e9matick\u00fdch sklizn\u00ed p\u0159i kontrole kvality sklizn\u011b.</p> <p>V praxi n\u00e1stroj hled\u00e1 soubory <code>*.warc.gz|*.arc.gz</code> ve vybran\u00e9m \u00falo\u017ei\u0161ti. A pomoc\u00ed sady pravidel vytvo\u0159\u00ed kolekci pro dan\u00e9 archivy. V kolekci vytvo\u0159\u00ed slo\u017eky <code>archive</code> a <code>indexes</code>. A do slo\u017eky <code>archive</code> vytvo\u0159\u00ed symbolick\u00e9 odkazy vedouc\u00ed do \u00falo\u017ei\u0161t\u011b. T\u00edmto zp\u016fsobem pywb okam\u017eit\u011b vid\u00ed nov\u00e9 kolekce. A jakmile dojde k vytvo\u0159en\u00ed indexu dan\u00e9 kolekce, je mo\u017en\u00e9 proch\u00e1zet jak samotnou kolekci, tak pou\u017e\u00edt souhrnou kolekci /wayback/, kter\u00e1 zobraz\u00ed v\u0161echny kolekce.</p> <p>\u00dalo\u017ei\u0161t\u011b je po \u0159ad\u011b incident\u016f fragmentov\u00e1no i mimo obvyklou strukturu <code>/mnt/archiv/{05..25}</code>. Collection manager s touto situac\u00ed um\u00ed pracovat. P\u0159\u00ed zpracov\u00e1n\u00ed roku \u00falo\u017ei\u0161t\u011b m\u00e1 p\u0159edkonfigurovan\u00e9 cesty, kde se archivy nach\u00e1zej\u00ed. P</p> <pre><code>case $param in\n        13)\n            ARCHIVE_YEAR=13\n            SEARCH_ROOT_DIR=/mnt/datas/178/archive13\n            ;;\n        14)\n            ARCHIVE_YEAR=14\n            SEARCH_ROOT_DIR=\"/mnt/datas/178/archive14 /mnt/datas/178/archive14 /mnt/datas/178/archive14Serials /mnt/datas/178/Archive14NDK-part /mnt/datas/180\"\n            ;;\n</code></pre> <pre><code>pywb-test@war2:~$ ./collection-manaager.sh 14\nProcessing Archive: 14. Mounted at /mnt/datas/178/archive14 /mnt/datas/178/archive14 /mnt/datas/178/archive14Serials /mnt/datas/178/Archive14NDK-part /mnt/datas/180. Time for coffer break.\n</code></pre> <p>Kolekce maj\u00ed prefix ve form\u00e1tu <code>YY</code>, ten odkazuje na rok \u00falo\u017eit\u011b. Prefix sni\u017euje \u0161anci na kolizi n\u00e1zv\u016f kolekc\u00ed, ale mo\u017enost kolizce nen\u00ed zcela vylou\u010dena. Je ale mo\u017en\u00e9 vytvo\u0159it kolekci bez prefixu, pokud se jedn\u00e1 nap\u0159\u00edklad o t\u00e9matickou sklize\u0148 nap\u0159\u00ed\u010d roky. Jde ale spojit Prezidensk\u00e9 volby z r\u016fzn\u00fdch let do jedn\u00e9 kolekce.</p> <pre><code>pywb-test@war2:/mnt/index/collections$ ls -1 *Serials* |grep Serials\n05-Serials:\n06-Serials:\n07-Serials:\n08-Serials:\n09-Serials:\n10-Serials:\n</code></pre> <p>Jedna kolekce m\u016f\u017ee obsahovat v\u00edce sklizn\u00ed. Nap\u0159\u00edklad v\u0161echny sklizn\u011b obsahuj\u00edc\u00ed n\u00e1zev Serials nebo serials, jsou uchov\u00e1ny v jedn\u00e9 kolekci Serials pro dan\u00fd rok. Nap\u0159. <code>/mnt/index/collections/05-Serials/archive/</code> obsahuje archivy ze sklizn\u00ed <code>2005-12-24-serials</code>, <code>2004-05-00-serials</code> a <code>2005-06-12-serials</code> ulo\u017een\u00fdch v <code>/mnt/archive/05/</code>.</p> <pre><code>IAH-20051224150339-00009-harvester.nkp.cz.arc.gz -&gt; /mnt/archive/05/serials/2005-12-24-serials/IAH-20051224150339-00009-harvester.nkp.cz.arc.gz\nNEDLIB--20051117164000-00000.arc.gz -&gt; /mnt/archive/05/serials/2004-05-00-serials/NEDLIB--20051117164000-00000.arc.gz\nneuroacta-20050617160122-00001.arc.gz -&gt; /mnt/archive/05/serials/2005-06-12-serials/neuroacta-20050617160122-00001.arc.gz\n</code></pre> <p>V\u0161echny kolekce existuj\u00ed v adres\u00e1\u0159i <code>/mnt/index/collections</code>. Pywb umo\u017e\u0148uje jen plochou strukturu kolekc\u00ed. Proto kolekce pou\u017e\u00edvaj\u00ed prefix roku, kde byl obsah archivov\u00e1n. P\u0159\u00edkad:</p> <pre><code>pywb-test@war2:/mnt/index/collections$ ls\n05-cz         05-militaria-20041212  06-estonia   06-Serials     06-zive_servery    07-Serials\n05-cz2004     05-Serials             06-harvest0  06-slovakia    07-cz2007          08-cz2008\n05-cz2005     05-vysocina            06-idnes     06-slovenia    07-MICR\n05-dalimil    06-cz2006              06-Ikaros    06-univerzity  07-novaBudovaNK\n05-info_muni  06-czech               06-povodne   06-volby2006   07-olympiadaPraha\n\npywb-test@war2:/mnt/index/collections$ tree -d\n.\n\u251c\u2500\u2500 05-cz\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 archive\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 indexes\n\u251c\u2500\u2500 05-cz2004\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 archive\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 indexes\n\u251c\u2500\u2500 05-cz2005\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 archive\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 indexes\n\u251c\u2500\u2500 05-dalimil\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 archive\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 indexes\n\u251c\u2500\u2500 05-info_muni\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 archive\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 indexes\n\u251c\u2500\u2500 05-militaria-20041212\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 archive\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 indexes\n\u251c\u2500\u2500 05-Serials\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 archive\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 indexes\n\u251c\u2500\u2500 05-vysocina\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 archive\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 indexes\n...\n</code></pre>"},{"location":"Pywb/spr%C3%A1va/#pouziti-collection-manager","title":"Pou\u017eit\u00ed Collection Manager","text":"<p>U\u017eivatel\u00e9 <code>pywb-test</code> a <code>pywb-prod</code> maj\u00ed p\u0159\u00edstup k n\u00e1stroji <code>collection-manager.sh</code> ze sv\u00e9 domovsk\u00e9 slo\u017eky.</p>"},{"location":"Pywb/spr%C3%A1va/#vytvoreni-kolekce-z-uloziste","title":"Vytvo\u0159en\u00ed kolekce z \u00falo\u017ei\u0161t\u011b","text":"<pre><code>./collection-manaager.sh 24\n</code></pre>"},{"location":"Pywb/spr%C3%A1va/#vytvoreni-kolekce-z-vice-ulozist","title":"Vytvo\u0159en\u00ed kolekce z v\u00edce \u00falo\u017ei\u0161\u0165","text":"<pre><code>for archive in 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24; do ./collection-manaager.sh ${archive}; done\n</code></pre> <p>V\u00fdstup po vytv\u00e1\u0159en\u00ed kolekce.</p> <pre><code>pywb-test@war2:~$ for archive in 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24; do ./collection-manaager.sh ${archive}; done\nProcessing Year: 05\nProcessing Year: 06\nProcessing Year: 07\nProcessing Year: 08\nProcessing Year: 09\nProcessing Year: 10\nProcessing Year: 11\nfind: \u2018/mnt/archive/11/.mmbackupCfg/prepFiles\u2019: Permission denied\nfind: \u2018/mnt/archive/11/.mmbackupCfg/expiredFiles\u2019: Permission denied\nfind: \u2018/mnt/archive/11/.mmbackupCfg/updatedFiles\u2019: Permission denied\nProcessing Year: 12\nProcessing Year: 13\nProcessing Year: 14\nProcessing Year: 15\nProcessing Year: 16\nProcessing Year: 17\nProcessing Year: 18\nProcessing Year: 19\nProcessing Year: 20\nProcessing Year: 21\nProcessing Year: 22\nProcessing Year: 23\nProcessing Year: 24\npywb-test@war2:~$\n</code></pre>"},{"location":"Pywb/spr%C3%A1va/#indexacni-nastroj-cdxj-managersh","title":"Indexa\u010dn\u00ed n\u00e1stroj ./cdxj-manager.sh","text":"<p>Je wrapper n\u00e1stroje cdxj-indexer. Slou\u017e\u00ed k vytvo\u0159en\u00ed indexu pro danou kolekci. Index je nutn\u00fd pro zobrazen\u00ed archivn\u00edch dat. Indexov\u00e1n\u00ed je \u010dasov\u011b n\u00e1ro\u010dn\u00fd proces.</p> <p>N\u00e1stroj nejd\u0159\u00edve zkontroluje zda-li index pro dan\u00fd archiv ji\u017e neexistue v adres\u00e1\u0159i <code>/mnt/index/cdxj-archive/</code>. Pokud existuje, zkop\u00edruje ji\u017e existuj\u00edc\u00ed index do ko\u0159ene adres\u00e1\u0159e kolekce <code>/mnt/index/collections/{{collection}/</code>. Pokud index neexistuje, n\u00e1stroj vytvo\u0159\u00ed index do ko\u0159ene adres\u00e1\u0159e kolekce <code>/mnt/index/collections/{{collection}/</code>. Zda-li byl index vytvo\u0159en nebo zkop\u00edrov\u00e1n je zaznamen\u00e1n do logu <code>/mnt/index/collections/{{collection}/${date -u --iso-8601}.log</code>.</p> <p>V logu je mo\u017en\u00e9 zjistit \u017eiv\u00e1 data z prob\u00edhaj\u00edc\u00ed indexace.</p> <pre><code>pywb-test@war2:/mnt/index/collections$ tail -f 05-cz/2025-01-05.log\n[2025-01-05T20:29:11+00:00] Processing /mnt/index/collections/05-cz/archive/NEDLIB--20051122211225-00000.arc.gz into /mnt/index/collections/05-cz/NEDLIB--20051122211225-00000.arc.gz.cdxj\n[2025-01-05T20:29:13+00:00] Processing /mnt/index/collections/05-cz/archive/NEDLIB--20051130094855-00000.arc.gz into /mnt/index/collections/05-cz/NEDLIB--20051130094855-00000.arc.gz.cdxj\n[2025-01-05T20:29:15+00:00] Processing /mnt/index/collections/05-cz/archive/NEDLIB--20051209053122-00000.arc.gz into /mnt/index/collections/05-cz/NEDLIB--20051209053122-00000.arc.gz.cdxj\n</code></pre> <p>Jakmile jsou v\u0161echny indexy archivy v kolekci vytvo\u0159en\u00e9. N\u00e1stroj set\u0159\u00edd\u00ed v\u0161echny <code>*.arc.gz</code> a <code>*.warc.gz</code> do souboru <code>/mnt/index/collections/{{collection}/indexes/index.cdxj</code>. A pot\u00e9 p\u0159esune indexy do <code>/mnt/index/cdxj-archive/</code>.</p> <p>V\u0161echny chybov\u00e9 zpr\u00e1vy vznikl\u00e9 p\u0159i indexaci jsou uchov\u00e1ny <code>/mnt/index/cdxj-archive/logs/{ARCHIVE_NAME}.cdxj.stderr</code>.</p>"},{"location":"Pywb/spr%C3%A1va/#indexace-jedne-kolekce","title":"Indexace jedn\u00e9 kolekce","text":"<pre><code>pywb-test@war2:~$ ./cdxj-manager.sh 05-cz\n</code></pre>"},{"location":"Pywb/spr%C3%A1va/#indexace-vice-kolekci","title":"Indexace v\u00edce kolekc\u00ed","text":"<p>Indexace v\u0161ech kolekc\u00ed z roku 05.</p> <pre><code>pywb-test@war2:~$ for collection in $(ls /mnt/index/collections/ |grep ^05-*); do ./cdxj-manager.sh $collection; done\n[2025-01-05T20:14:38+00:00] Processing 05-cz\n</code></pre>"},{"location":"Pywb/spr%C3%A1va/#nastroje-pywb","title":"N\u00e1stroje pywb","text":""},{"location":"Pywb/spr%C3%A1va/#jak-zjistit-z-jake-kolekce-url-pochazi","title":"Jak zjistit z jak\u00e9 kolekce URL poch\u00e1z\u00ed?","text":"<p>MementoAPI poskytuje informace o URL. V\u00fdstup obsahuje informace o URL, kolekci, \u010dasov\u00e9 zn\u00e1mce a kolekci.</p> <pre><code>pywb-test@war2:~$ curl http://10.3.0.21:443/wayback/timemap/link/http://underground.cz/814\n&lt;http://10.3.0.21:443/wayback/timemap/link/http://underground.cz/814&gt;; rel=\"self\"; type=\"application/link-format\"; from=\"Sun, 14 Jul 2002 18:04:22 GMT\",\n&lt;http://10.3.0.21:443/wayback/http://underground.cz/814&gt;; rel=\"timegate\",\n&lt;http://underground.cz/814&gt;; rel=\"original\",\n&lt;http://10.3.0.21:443/wayback/20020714180422mp_/http://underground.cz/814&gt;; rel=\"memento\"; datetime=\"Sun, 14 Jul 2002 18:04:22 GMT\"; collection=\"05-cz\"\n</code></pre>"},{"location":"Pywb/spr%C3%A1va/#ziskani-metadata-o-url-pomoci-cdx","title":"Z\u00edsk\u00e1n\u00ed metadata o URL pomoc\u00ed cdx?","text":"<p>Pywb UI</p> <pre><code>pywb-test@war2 curl -s '10.3.0.21:443/wayback/cdx?url=www.facebook.com/legal/terms&amp;output=json'\n</code></pre> <p>vrac\u00ed</p> <pre><code>{\n  \"urlkey\": \"com,facebook)/legal/terms\",\n  \"timestamp\": \"20221209191852\",\n  \"url\": \"https://www.facebook.com/legal/terms\",\n  \"mime\": \"text/html\",\n  \"status\": \"200\",\n  \"digest\": \"GRUWGB5ZAMAPKEAC2DOOD2AEY7M6P2EZ\",\n  \"length\": \"290673\",\n  \"offset\": \"496164353\",\n  \"filename\": \"rec-20221209182111914788-65f062a0d7a3.warc.gz\",\n  \"source\": \"1222_prezident23/indexes/index.cdxj\",\n  \"source-coll\": \"1222_prezident23\",\n  \"access\": \"allow\"\n}\n</code></pre>"},{"location":"Pywb/spr%C3%A1va/#indexacni-nastroj-wb-manager-reindexsh","title":"Indexa\u010dn\u00ed n\u00e1stroj ./wb-manager-reindex.sh","text":"<p>[!WARNING] Tento n\u00e1stroj je omezen\u00fd po\u010dtem pam\u011bti serveru. Proto se nehod\u00ed na v\u011bt\u0161\u00ed sklizn\u011b. S ka\u017ed\u00fdm nov\u00fdm archivem v kolekci, stoupa spot\u0159eba pam\u011bti. N\u00e1stroj ./cdxj-manager.sh by m\u011bl b\u00fdt spolehliv\u011bj\u0161\u00ed..</p> <p>Je wrapper n\u00e1stroje pywb manager. Slou\u017e\u00ed k vytvo\u0159en\u00ed indexu pro danou kolekci. Index je nutn\u00fd pro zobrazen\u00ed archivn\u00edch dat. Indexov\u00e1n\u00ed je \u010dasov\u011b n\u00e1ro\u010dn\u00fd proces. Indexov\u00e1n\u00ed je mo\u017en\u00e9 spustit pro jednu kolekci.</p> <p>Wrapper spust\u00ed p\u0159\u00edklaz wb-manager reindex uvnit\u0159 kontejneru pywb. P\u0159\u00edkaz vy\u017eaduje n\u00e1zev kolekce. N\u00e1zev kolekce je n\u00e1zev slo\u017eky v adres\u00e1\u0159i <code>/mnt/index/collections/</code>. Wrapper na konci indeakce vyp\u00ed\u0161e dobu trv\u00e1n\u00ed indexace a v\u0161echny chyby ulo\u017e\u00ed do slo\u017eky <code>/home/{pywb-test|pywb-prod}/logs/</code>, dle u\u017eivatele, kter\u00fd n\u00e1stroj spustil.</p>"},{"location":"Pywb/spr%C3%A1va/#indexace-jedne-kolekce_1","title":"Indexace jedn\u00e9 kolekce","text":"<pre><code>pywb-test@war2:~$ ./wb-manager-reindex.sh 05-cz\nindexing collection: 05-cz\n\n</code></pre>"},{"location":"Pywb/spr%C3%A1va/#indexace-vice-kolekci_1","title":"Indexace v\u00edce kolekc\u00ed","text":"<pre><code>pywb-test@war2:~$ for collection in /mnt/index/collections/{05,06,07,08,09,10,11,12}*; do ./wb-manager-reindex.sh $(basename ${collection}); done\nindexing collection: 05-cz\n</code></pre> <p>V\u00fdstup seznamu nalazen\u00fdch kolekc\u00ed.</p> <pre><code>pywb-test@war2:~$ for collection in /mnt/index/collections/{05,06,07,08,09,10,11,12}*; do echo $(basename ${collection}); done\n05-cz\n05-cz2004\n05-cz2005\n05-dalimil\n05-info_muni\n05-militaria-20041212\n05-Serials\n05-vysocina\n06-cz2006\n06-czech\n06-estonia\n06-harvest0\n06-idnes\n06-Ikaros\n06-povodne\n06-Serials\n06-slovakia\n06-slovenia\n06-univerzity\n06-volby2006\n06-zive_servery\n07-cz2007\n07-MICR\n07-novaBudovaNK\n07-olympiadaPraha\n07-Serials\n08-cz2008\n08-novaBudovaNK\n08-novaBudovaSTK\n08-Serials\n08-volba-prezident-2008\n08-vyroci68\n09-cz2009\n09-evropskeVolby2009\n09-komunismusIdnes\n09-liberec\n09-novaBudovaNK\n09-novaBudovaSTK\n09-predsednictviEU\n09-selectedSites\n09-selective\n09-Serials\n09-testing\n10-cz2010\n10-Serials\n11-ArchiveIt\n11-cz2011\n11-Havel-2011\n11-Serials\n11-test_files\n12-ArchiveIt\n12-Bloguje-2012\n12-Extras\n12-Havel-2011\n12-NKP-2012\n12-Serials\n12-testCrawls\n</code></pre>"}]}